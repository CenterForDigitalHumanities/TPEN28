<!DOCTYPE html>
<!--
TPEN 2.8
authors: bhaberbe and cubap
-->
<html>
    <head>
        <title>Login or Register a New Account</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <link rel="stylesheet" href="css/tpen.css" type="text/css" media="screen, projection">
        <link type="text/css" href="css/custom-theme/jQuery.css" rel="Stylesheet" />
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.js"></script>
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.js"></script>
        <script type="text/javascript" src="js/newberry.js"></script>
        <style>
            #loginsuccess, #loginfail{
                display: none;
                cursor: default !important;
            }
            .login, #register { width: 45%;padding:10px;}
            #content {max-width: 800px;}
            #forgetForm {margin:-4px 5px 2px;background: url(images/linen.png);padding:10px 15px;display:none;overflow: hidden;z-index: 1; border: 1px solid #A68329;
                         box-shadow:-1px -1px 2px black;}
            #forgetFormBtn {position: relative;z-index: 2;cursor: pointer;margin: 0 0 5px 0;}
        </style>
    </head>
    <body>
        <div id="loginfail" >
            <style type="text/css">
                body {visibility: visible !important;}
            </style>
            <div id="urgentError">
                <p id="errorMessage"><%out.print(message);%></p>
                <a href='index.jsp'>T&#8209;PEN Home</a>
            </div>
            <div id="trexHead"></div>
        </div>
        <div id="wrapper">
            <div id="header"><p align="center" class="tagline">transcription for paleographical and editorial notation</p>
            </div>
            <div id="content">
                <h1><script>document.write(document.title);</script></h1>
                <div id="main" class="ui-widget ui-widget-content ui-corner-all ui-tabs ui-helper-reset ui-helper-clearfix">
                    <div class="login left">
                        <p> You may log into your account to start transcribing or to manage your projects.</p>
                        <div id="resetPassword">
                            <h6 id="forgetFormBtn" class="clear-right">Forgot your Password?<span class="left ui-icon ui-icon-arrowstop-1-s"></span></h6>
                            <form id="forgetForm" action="admin.jsp" method="POST" class="ui-corner-all">
                                <span>Enter the email address associated with your account to have your password reset.</span>
                                <input id="email" type="text" class="text" style="width:220px;" placeholder="Forgot your password?" name="email">
                                <input class="right ui-corner-all ui-state-default" type="submit" name="emailSubmitted" value="Reset Password"/>
                            </form>
                        </div>

                        <div class="login">
                            <fieldset>
                                <legend>Login Here:</legend>
                                <label for="uname">Email</label> <input class="text" type="text" id="uname"/> <br/>
                                <label for="password">Password</label> <input class="text" type="password" id="password"/> <br/>
                                <input class="ui-button ui-state-default ui-corner-all right" type="button" title="Log In" value="Log In"
                                       onclick="userLogin();">
                            </fieldset>
                        </div>
                    </div>
                    <div id="register" class="right">
                        <h3 class="ui-widget-header ui-tabs ui-corner-all ui-state-default">Register a New Account</h3>
                        <form action="signup.jsp" method="POST">
                            <fieldset>
                                <legend>or Register as a New User:</legend>
                                Note: You will receive your password via email after your account is activated by an administrator
                                <label for="uname">Email</label><input class="text" type="text" name="uname"/><br/>
                                <label for="fname">First Name</label><input class="text" type="text" id="fname" name="fname"/><br/>
                                <label for="lname">Last Name</label><input class="text" type="text" id="lname" name="lname"/><br/>
                                <input type="submit" value="Register" class="ui-button ui-state-default ui-corner-all right"/>
                            </fieldset>
                        </form>
                    </div>
                </div>
                <a class="returnButton" href="index.jsp">Return to T&#8209;PEN Home</a>

            </div>
        </div>
        <script>
            function userLogin () {
                var userName = $('#uname')
                    .val();
                var password = $('#password')
                    .val();
                if (userName !== undefined && userName !== "" && password !== undefined && password !== "") {
                    var url = "login";
                    var params = {
                        "uname": userName, "password": password
                    };
                    $.post(url, params, function () {

                    })
                        .done(function () {
                            $("#loginfail")
                                .hide();
                        })
                        .fail(function (error) {
                            $("#loginfail")
                                .children("p")
                                .html(error.status + ":" + error.statusText);
                        });
                }
                else {
                    alert('You must enter a user name (E-mail) and password!');
                }
            }
        </script>
    </body>
</html>
